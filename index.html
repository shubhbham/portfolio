<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 10;
            padding: 10;
        }

        .container {

            /* Smartphones */

            @media only screen and (min-device-width : 320px) and (max-device-width : 480px) {
                /* Styles */
            }

            /* iPads */
            @media only screen and (min-device-width : 768px) and (max-device-width : 1024px) {
                /* Styles */
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="code-wrap">
            <pre>
                <code id="code">
                <h2>college database</h2>
                create table STUDENT(USN varchar(30), Sname varchar(30), Address varchar(30), Phone varchar(30), Gender char(1), constraint pkystudent primary key(USN));

                create table SEM_SECTION(SSID varchar(30),Sem int,Section varchar(5),constraint pkysemsection primary key(SSID));
                
                create table CLASS(USN varchar(30),SSID varchar(30),constraint pkyclass primary key(USN),constraint fkyclass1 foreign key(USN) references STUDENT(USN),
                constraint fkyclass2 foreign key(SSID) references SEM_SECTION(SSID));
                
                create table SUBJECT(Subject_code varchar(10),Title varchar(30),Sem int,Credits int,constraint pkysubject primary key(Subject_code));
                
                create table IA_MARKS(USN varchar(30),Subject_code varchar(10),SSID varchar(30),Test1 int,Test2 int,Test3 int,Final_IA int,
                constraint pkyiamarks primary key(USN,Subject_code,SSID),constraint fkyiamarks1 foreign key(USN) references STUDENT(USN),
                constraint fkyiamarks2 foreign key(Subject_code) references SUBJECT(Subject_code),constraint fkyiamarks3 foreign key(SSID) references SEM_SECTION(SSID));
                
                
                insert into STUDENT values('4NN15CS001','Ankitha','Vijaynagar','9880067777','F');
                insert into STUDENT values('4NN15CS002','Anil','Vijaynagar','9880067778','M');
                insert into STUDENT values('4NN15CS003','Deepika','Jaynagar','9880067779','F');
                insert into STUDENT values('4NN15CS004','Rajesh','Kuvempunagar','9880067775','M');
                insert into STUDENT values('4NN15CS005','Sanvi','Srinagar','9880067774','F');
                insert into STUDENT values('4NN15CS006','Shravya','Yadavgiri','9880067773','F');
                insert into STUDENT values('4NN15CS007','Shruthi','Yadavgiri','9880067772','F');
                insert into STUDENT values('4NN15CS008','Mahesh','Yadavgiri','9880067771','M');
                insert into STUDENT values('4NN15CS009','Amit','Jaynagar','9880067770','M');
                insert into STUDENT values('4NN15CS010','Aditya','Jaynagar','9880067776','M');
                
                
                
                insert into SEM_SECTION values(11,4,'A');
                insert into SEM_SECTION values(12,4,'B');
                insert into SEM_SECTION values(13,4,'C');
                insert into SEM_SECTION values(14,8,'A');
                insert into SEM_SECTION values(15,8,'C');
                insert into SEM_SECTION values(16,8,'B');
                
                
                insert into CLASS values('4NN15CS001',11);
                insert into CLASS values('4NN15CS002',13);
                insert into CLASS values('4NN15CS003',15);
                insert into CLASS values('4NN15CS004',14);
                insert into CLASS values('4NN15CS005',15);
                insert into CLASS values('4NN15CS006',16);
                insert into CLASS values('4NN15CS007',11);
                insert into CLASS values('4NN15CS008',11);
                insert into CLASS values('4NN15CS009',14);
                insert into CLASS values('4NN15CS010',13);
                
                
                insert into SUBJECT values('15CS41','Maths',4,4);
                insert into SUBJECT values('15CS42','USP',4,4);
                insert into SUBJECT values('15CS43','DMS',4,4);
                insert into SUBJECT values('15CS61','SMS',8,3);
                insert into SUBJECT values('15CS62','INS',8,3);
                insert into SUBJECT values('15CS63','ADHOC',8,3);
                insert into SUBJECT values('15CS81','SMS',8,3);
                insert into SUBJECT values('15CS82','INS',8,3);
                insert into SUBJECT values('15CS83','ADHOC',8,3);
                
                
                
                insert into IA_MARKS values('4NN15CS001','15CS41',11,14,15,16,null);
                insert into IA_MARKS values('4NN15CS001','15CS42',11,13,15,16,null);
                insert into IA_MARKS values('4NN15CS001','15CS43',11,14,20,16,null);
                
                insert into IA_MARKS values('4NN15CS002','15CS41',13,14,15,16,null);
                insert into IA_MARKS values('4NN15CS002','15CS42',13,14,18,16,null);
                insert into IA_MARKS values('4NN15CS002','15CS43',13,14,15,17,null);
                
                insert into IA_MARKS values('4NN15CS003','15CS81',15,14,15,16,null);
                insert into IA_MARKS values('4NN15CS003','15CS82',15,15,16,16,null);
                insert into IA_MARKS values('4NN15CS003','15CS83',15,18,15,16,null);
                
                insert into IA_MARKS values('4NN15CS004','15CS81',14,16,15,16,null);
                insert into IA_MARKS values('4NN15CS004','15CS82',14,14,17,17,null);
                insert into IA_MARKS values('4NN15CS004','15CS83',14,18,15,20,null);
                
                insert into IA_MARKS values('4NN15CS005','15CS81',15,14,15,16,null);
                insert into IA_MARKS values('4NN15CS005','15CS82',15,17,14,16,null);
                insert into IA_MARKS values('4NN15CS005','15CS83',15,19,15,20,null);
                
                insert into IA_MARKS values('4NN15CS006','15CS81',16,19,15,14,null);
                insert into IA_MARKS values('4NN15CS006','15CS82',16,17,18,16,null);
                insert into IA_MARKS values('4NN15CS006','15CS83',16,19,12,20,null);
                
                insert into IA_MARKS values('4NN15CS007','15CS41',11,16,15,16,null);
                insert into IA_MARKS values('4NN15CS007','15CS42',11,12,15,16,null);
                insert into IA_MARKS values('4NN15CS007','15CS43',11,14,20,16,null);
                
                insert into IA_MARKS values('4NN15CS008','15CS41',11,16,15,16,null);
                insert into IA_MARKS values('4NN15CS008','15CS42',11,13,15,16,null);
                insert into IA_MARKS values('4NN15CS008','15CS43',11,18,20,16,null);
                
                
                insert into IA_MARKS values('4NN15CS009','15CS81',14,15,15,16,null);
                insert into IA_MARKS values('4NN15CS009','15CS82',14,17,17,18,null);
                insert into IA_MARKS values('4NN15CS009','15CS83',14,18,14,20,null);
                
                insert into IA_MARKS values('4NN15CS010','15CS41',13,14,15,16,null);
                insert into IA_MARKS values('4NN15CS010','15CS42',13,14,18,16,null);
                insert into IA_MARKS values('4NN15CS010','15CS43',13,14,15,17,null);
                
                
                MariaDB [college]> select * from STUDENT;
                +------------+---------+--------------+------------+--------+
                | USN        | Sname   | Address      | Phone      | Gender |
                +------------+---------+--------------+------------+--------+
                | 4NN15CS001 | Ankitha | Vijaynagar   | 9880067777 | F      |
                | 4NN15CS002 | Anil    | Vijaynagar   | 9880067778 | M      |
                | 4NN15CS003 | Deepika | Jaynagar     | 9880067779 | F      |
                | 4NN15CS004 | Rajesh  | Kuvempunagar | 9880067775 | M      |
                | 4NN15CS005 | Sanvi   | Srinagar     | 9880067774 | F      |
                | 4NN15CS006 | Shravya | Yadavgiri    | 9880067773 | F      |
                | 4NN15CS007 | Shruthi | Yadavgiri    | 9880067772 | F      |
                | 4NN15CS008 | Mahesh  | Yadavgiri    | 9880067771 | M      |
                | 4NN15CS009 | Amit    | Jaynagar     | 9880067770 | M      |
                | 4NN15CS010 | Aditya  | Jaynagar     | 9880067776 | M      |
                +------------+---------+--------------+------------+--------+
                10 rows in set (0.00 sec)
                
                MariaDB [college]> select * from SEM_SECTION;
                +------+------+---------+
                | SSID | Sem  | Section |
                +------+------+---------+
                | 11   |    4 | A       |
                | 12   |    4 | B       |
                | 13   |    4 | C       |
                | 14   |    8 | A       |
                | 15   |    8 | C       |
                | 16   |    8 | B       |
                +------+------+---------+
                6 rows in set (0.00 sec)
                
                MariaDB [college]> select * from CLASS;
                +------------+------+
                | USN        | SSID |
                +------------+------+
                | 4NN15CS001 | 11   |
                | 4NN15CS007 | 11   |
                | 4NN15CS008 | 11   |
                | 4NN15CS002 | 13   |
                | 4NN15CS010 | 13   |
                | 4NN15CS004 | 14   |
                | 4NN15CS009 | 14   |
                | 4NN15CS003 | 15   |
                | 4NN15CS005 | 15   |
                | 4NN15CS006 | 16   |
                +------------+------+
                10 rows in set (0.00 sec)
                
                MariaDB [college]> select * from SUBJECT;
                +--------------+-------+------+---------+
                | Subject_code | Title | Sem  | Credits |
                +--------------+-------+------+---------+
                | 15CS41       | Maths |    4 |       4 |
                | 15CS42       | USP   |    4 |       4 |
                | 15CS43       | DMS   |    4 |       4 |
                | 15CS61       | SMS   |    8 |       3 |
                | 15CS62       | INS   |    8 |       3 |
                | 15CS63       | ADHOC |    8 |       3 |
                | 15CS81       | SMS   |    8 |       3 |
                | 15CS82       | INS   |    8 |       3 |
                | 15CS83       | ADHOC |    8 |       3 |
                +--------------+-------+------+---------+
                9 rows in set (0.00 sec)
                
                MariaDB [college]> select * from IA_MARKS;
                +------------+--------------+------+-------+-------+-------+----------+
                | USN        | Subject_code | SSID | Test1 | Test2 | Test3 | Final_IA |
                +------------+--------------+------+-------+-------+-------+----------+
                | 4NN15CS001 | 15CS41       | 11   |    14 |    15 |    16 |     NULL |
                | 4NN15CS001 | 15CS42       | 11   |    13 |    15 |    16 |     NULL |
                | 4NN15CS001 | 15CS43       | 11   |    14 |    20 |    16 |     NULL |
                | 4NN15CS002 | 15CS41       | 13   |    14 |    15 |    16 |     NULL |
                | 4NN15CS002 | 15CS42       | 13   |    14 |    18 |    16 |     NULL |
                | 4NN15CS002 | 15CS43       | 13   |    14 |    15 |    17 |     NULL |
                | 4NN15CS003 | 15CS81       | 15   |    14 |    15 |    16 |     NULL |
                | 4NN15CS003 | 15CS82       | 15   |    15 |    16 |    16 |     NULL |
                | 4NN15CS003 | 15CS83       | 15   |    18 |    15 |    16 |     NULL |
                | 4NN15CS004 | 15CS81       | 14   |    16 |    15 |    16 |     NULL |
                | 4NN15CS004 | 15CS82       | 14   |    14 |    17 |    17 |     NULL |
                | 4NN15CS004 | 15CS83       | 14   |    18 |    15 |    20 |     NULL |
                | 4NN15CS005 | 15CS81       | 15   |    14 |    15 |    16 |     NULL |
                | 4NN15CS005 | 15CS82       | 15   |    17 |    14 |    16 |     NULL |
                | 4NN15CS005 | 15CS83       | 15   |    19 |    15 |    20 |     NULL |
                | 4NN15CS006 | 15CS81       | 16   |    19 |    15 |    14 |     NULL |
                | 4NN15CS006 | 15CS82       | 16   |    17 |    18 |    16 |     NULL |
                | 4NN15CS006 | 15CS83       | 16   |    19 |    12 |    20 |     NULL |
                | 4NN15CS007 | 15CS41       | 11   |    16 |    15 |    16 |     NULL |
                | 4NN15CS007 | 15CS42       | 11   |    12 |    15 |    16 |     NULL |
                | 4NN15CS007 | 15CS43       | 11   |    14 |    20 |    16 |     NULL |
                | 4NN15CS008 | 15CS41       | 11   |    16 |    15 |    16 |     NULL |
                | 4NN15CS008 | 15CS42       | 11   |    13 |    15 |    16 |     NULL |
                | 4NN15CS008 | 15CS43       | 11   |    18 |    20 |    16 |     NULL |
                | 4NN15CS009 | 15CS81       | 14   |    15 |    15 |    16 |     NULL |
                | 4NN15CS009 | 15CS82       | 14   |    17 |    17 |    18 |     NULL |
                | 4NN15CS009 | 15CS83       | 14   |    18 |    14 |    20 |     NULL |
                | 4NN15CS010 | 15CS41       | 13   |    14 |    15 |    16 |     NULL |
                | 4NN15CS010 | 15CS42       | 13   |    14 |    18 |    16 |     NULL |
                | 4NN15CS010 | 15CS43       | 13   |    14 |    15 |    17 |     NULL |
                +------------+--------------+------+-------+-------+-------+----------+
                30 rows in set (0.00 sec)
                
                QUERIES
                
                1. List all the student details studying in fourth semester ‘C’ section.
                2. Compute the total number of male and female students in each semester and in
                each section.
                3. Create a view of Test1 marks of student USN ‘1BI15CS101’ in all Courses.
                4. Calculate the FinalIA (average of best two test marks) and update the
                corresponding table for all students.
                5. Categorize students based on the following criterion:
                If FinalIA = 17 to 20 then CAT = ‘Outstanding’
                If FinalIA = 12 to 16 then CAT = ‘Average’
                If FinalIA< 12 then CAT = ‘Weak’
                Give these details only for 8th semester A, B, and C section students.
                
                
                1)select S.*,SS.Sem,SS.Section
                from STUDENT S,SEM_SECTION SS,CLASS C
                where S.USN=C.USN and 
                SS.SSID=C.SSID
                and SS.sem=4
                and SS.Section='C';
                
                +------------+--------+------------+------------+--------+------+---------+
                | USN        | Sname  | Address    | Phone      | Gender | Sem  | Section |
                +------------+--------+------------+------------+--------+------+---------+
                | 4NN15CS002 | Anil   | Vijaynagar | 9880067778 | M      |    4 | C       |
                | 4NN15CS010 | Aditya | Jaynagar   | 9880067776 | M      |    4 | C       |
                +------------+--------+------------+------------+--------+------+---------+
                2 rows in set (0.00 sec)
                
                
                2)select SS.Sem,SS.Section,S.Gender,count(S.Gender) as count
                from  STUDENT S,SEM_SECTION SS,CLASS C
                where S.USN=C.USN
                and SS.SSID=C.SSID
                group by SS.Sem,SS.Section,S.Gender
                order by Sem; 
                
                +------+---------+--------+-------+
                | Sem  | Section | Gender | count |
                +------+---------+--------+-------+
                |    4 | A       | F      |     2 |
                |    4 | A       | M      |     1 |
                |    4 | C       | M      |     2 |
                |    8 | A       | M      |     2 |
                |    8 | B       | F      |     1 |
                |    8 | C       | F      |     2 |
                +------+---------+--------+-------+
                6 rows in set (0.00 sec)
                
                
                
                3)create view Stu_test1_marks as
                select Test1,Subject_code
                from IA_MARKS
                where USN='4NN15CS007';
                
                select * from Stu_test1_marks;
                
                +-------+--------------+
                | Test1 | Subject_code |
                +-------+--------------+
                |    16 | 15CS41       |
                |    12 | 15CS42       |
                |    14 | 15CS43       |
                +-------+--------------+
                3 rows in set (0.00 sec)
                
                4)delimiter $$
                drop procedure if exists avgmarks $$
                create procedure avgmarks()
                begin
                update IA_MARKS
                set Final_IA=(((Test1+Test2+Test3)-least(Test1,Test2,Test3))/2);
                end $$
                
                select * from IA_MARKS;
                
                call avgmarks();
                
                select * from IA_MARKS; 
                $$
                
                +------------+--------------+------+-------+-------+-------+----------+
                | USN        | Subject_code | SSID | Test1 | Test2 | Test3 | Final_IA |
                +------------+--------------+------+-------+-------+-------+----------+
                | 4NN15CS001 | 15CS41       | 11   |    14 |    15 |    16 |       16 |
                | 4NN15CS001 | 15CS42       | 11   |    13 |    15 |    16 |       16 |
                | 4NN15CS001 | 15CS43       | 11   |    14 |    20 |    16 |       18 |
                | 4NN15CS002 | 15CS41       | 13   |    14 |    15 |    16 |       16 |
                | 4NN15CS002 | 15CS42       | 13   |    14 |    18 |    16 |       17 |
                | 4NN15CS002 | 15CS43       | 13   |    14 |    15 |    17 |       16 |
                | 4NN15CS003 | 15CS81       | 15   |    14 |    15 |    16 |       16 |
                | 4NN15CS003 | 15CS82       | 15   |    15 |    16 |    16 |       16 |
                | 4NN15CS003 | 15CS83       | 15   |    18 |    15 |    16 |       17 |
                | 4NN15CS004 | 15CS81       | 14   |    16 |    15 |    16 |       16 |
                | 4NN15CS004 | 15CS82       | 14   |    14 |    17 |    17 |       17 |
                | 4NN15CS004 | 15CS83       | 14   |    18 |    15 |    20 |       19 |
                | 4NN15CS005 | 15CS81       | 15   |    14 |    15 |    16 |       16 |
                | 4NN15CS005 | 15CS82       | 15   |    17 |    14 |    16 |       17 |
                | 4NN15CS005 | 15CS83       | 15   |    19 |    15 |    20 |       20 |
                | 4NN15CS006 | 15CS81       | 16   |    19 |    15 |    14 |       17 |
                | 4NN15CS006 | 15CS82       | 16   |    17 |    18 |    16 |       18 |
                | 4NN15CS006 | 15CS83       | 16   |    19 |    12 |    20 |       20 |
                | 4NN15CS007 | 15CS41       | 11   |    16 |    15 |    16 |       16 |
                | 4NN15CS007 | 15CS42       | 11   |    12 |    15 |    16 |       16 |
                | 4NN15CS007 | 15CS43       | 11   |    14 |    20 |    16 |       18 |
                | 4NN15CS008 | 15CS41       | 11   |    16 |    15 |    16 |       16 |
                | 4NN15CS008 | 15CS42       | 11   |    13 |    15 |    16 |       16 |
                | 4NN15CS008 | 15CS43       | 11   |    18 |    20 |    16 |       19 |
                | 4NN15CS009 | 15CS81       | 14   |    15 |    15 |    16 |       16 |
                | 4NN15CS009 | 15CS82       | 14   |    17 |    17 |    18 |       18 |
                | 4NN15CS009 | 15CS83       | 14   |    18 |    14 |    20 |       19 |
                | 4NN15CS010 | 15CS41       | 13   |    14 |    15 |    16 |       16 |
                | 4NN15CS010 | 15CS42       | 13   |    14 |    18 |    16 |       17 |
                | 4NN15CS010 | 15CS43       | 13   |    14 |    15 |    17 |       16 |
                +------------+--------------+------+-------+-------+-------+----------+
                30 rows in set (0.00 sec)
                
                
                5) select S.USN,S.Address,S.Sname,S.Phone,S.Gender,
                  (case
                when IA.Final_IA between 17 and 20 then 'outstanding'
                when IA.Final_IA between 12 and 16 then 'average' else 
                'weak' END) as CATEGORY
                from STUDENT S ,SEM_SECTION SS,IA_MARKS IA,SUBJECT SUB
                WHERE S.USN=IA.USN and
                SUB.Subject_code=IA.Subject_code and
                SS.SSID=IA.SSID and
                SUB.Sem=8;
                
                +------------+--------------+---------+------------+--------+-------------+
                | USN        | Address      | Sname   | Phone      | Gender | CAT         |
                +------------+--------------+---------+------------+--------+-------------+
                | 4NN15CS004 | Kuvempunagar | Rajesh  | 9880067775 | M      | average     |
                | 4NN15CS004 | Kuvempunagar | Rajesh  | 9880067775 | M      | outstanding |
                | 4NN15CS004 | Kuvempunagar | Rajesh  | 9880067775 | M      | outstanding |
                | 4NN15CS009 | Jaynagar     | Amit    | 9880067770 | M      | average     |
                | 4NN15CS009 | Jaynagar     | Amit    | 9880067770 | M      | outstanding |
                | 4NN15CS009 | Jaynagar     | Amit    | 9880067770 | M      | outstanding |
                | 4NN15CS003 | Jaynagar     | Deepika | 9880067779 | F      | average     |
                | 4NN15CS003 | Jaynagar     | Deepika | 9880067779 | F      | average     |
                | 4NN15CS003 | Jaynagar     | Deepika | 9880067779 | F      | outstanding |
                | 4NN15CS005 | Srinagar     | Sanvi   | 9880067774 | F      | average     |
                | 4NN15CS005 | Srinagar     | Sanvi   | 9880067774 | F      | outstanding |
                | 4NN15CS005 | Srinagar     | Sanvi   | 9880067774 | F      | outstanding |
                | 4NN15CS006 | Yadavgiri    | Shravya | 9880067773 | F      | outstanding |
                | 4NN15CS006 | Yadavgiri    | Shravya | 9880067773 | F      | outstanding |
                | 4NN15CS006 | Yadavgiri    | Shravya | 9880067773 | F      | outstanding |
                +------------+--------------+---------+------------+--------+-------------+
                15 rows in set (0.00 sec)
                
                
                
                          



          

                <h2>Library database</h2>

                create table Publisher(Publisher_name varchar(30), Address varchar(30), Phone varchar(30), 
                constraint pkyPublisher primary key(Publisher_name));
                
                create table Book(Book_id integer,Title varchar(30),Publisher_name varchar(30),Publish_year integer, 
                constraint pkyBook primary key(Book_id),
                constraint fkyBook foreign key(Publisher_name) references Publisher(Publisher_name) on delete cascade);
                
                create table Book_Authors(Book_id integer,Author_name varchar(30),constraint pkyBookAuthors primary key(Book_id),
                constraint fkyBookAuthors foreign key(Book_id) references Book(Book_id) on delete cascade);
                
                create table Library_programme(programme_id integer,programme_name varchar(30),Address varchar(30),
                constraint pkyLibprogramme primary key(programme_id));
                
                create table Book_Copies(Book_id integer,programme_id integer,No_of_copies integer,
                constraint pkyBookCopies primary key(Book_id,programme_id),
                constraint fkyBookCopies1 foreign key(Book_id) references Book(Book_id) on delete cascade,
                constraint fkyBookCopies2 foreign key(programme_id) references Library_programme(programme_id) on delete cascade);
                
                create table Book_Lending(Book_id integer,programme_id integer,Card_no varchar(30),Date_Out date,Due_Date date,
                constraint pkyBookLen primary key(Book_id,programme_id,Card_no),
                constraint fkyBookLen1 foreign key(Book_id) references Book(Book_id) on delete cascade,
                constraint fkyBookLen2 foreign key(programme_id) references Library_branch(programme_id) on delete cascade);
                
                (1)
                
                insert into Publisher values('PHI','India',9880066666);
                insert into Publisher values('McGraw Hill','India',9880066777);
                insert into Publisher values('Sapna','India',9880066888);
                insert into Publisher values('Andearson','India',9880066999);
                insert into Publisher values('Tata','India',9880066555);
                insert into Publisher values('Dreamtech','India',9880066444);
                insert into Publisher values('MHI','India','9880077755');
                
                mysql> SELECT * FROM PUBLISHER;
                +----------------+---------+------------+
                | Publisher_name | Address | Phone      |
                +----------------+---------+------------+
                | Andearson      | India   | 9880066999 |
                | Dreamtech      | India   | 9880066444 |
                | McGraw Hill    | India   | 9880066777 |
                | MHI            | India   | 9880077755 |
                | PHI            | India   | 9880066666 |
                | Sapna          | India   | 9880066888 |
                | Tata           | India   | 9880066555 |
                +----------------+---------+------------+
                7 rows in set (0.00 sec)
                
                (2)
                
                insert into Book values(101,'Programming in C','PHI',2000);
                insert into Book values(102,'Programming in C#','MHI',2002);
                insert into Book values(103,'Computer Netwokrs','Dreamtech',2006);
                insert into Book values(104,'Unix Shell Programming','PHI',2000);
                insert into Book values(105,'Compiler Design','PHI',2010);
                insert into Book values(106,'Database Management Systems','PHI',2008);
                
                mysql> SELECT * FROM BOOK;
                +---------+-----------------------------+----------------+--------------+
                | Book_id | Title                       | Publisher_name | Publish_year |
                +---------+-----------------------------+----------------+--------------+
                |     101 | Programming in C            | PHI            |         2000 |
                |     102 | Programming in C#           | MHI            |         2002 |
                |     103 | Computer Netwokrs           | Dreamtech      |         2006 |
                |     104 | Unix Shell Programming      | PHI            |         2000 |
                |     105 | Compiler Design             | PHI            |         2010 |
                |     106 | Database Management Systems | PHI            |         2008 |
                +---------+-----------------------------+----------------+--------------+
                6 rows in set (0.00 sec)
                
                
                (3)
                insert into Book_Authors values(101,'Balaguruswamy');
                insert into Book_Authors values(102,'Andearson');
                insert into Book_Authors values(103,'Ferouzan');
                insert into Book_Authors values(104,'Sumitabha Das');
                insert into Book_Authors values(105,'Kumar');
                insert into Book_Authors values(106,'Tanenbaum');
                
                mysql> SELECT * FROM BOOK_AUTHORS;
                +---------+---------------+
                | Book_id | Author_name   |
                +---------+---------------+
                |     101 | Balaguruswamy |
                |     102 | Andearson     |
                |     103 | Ferouzan      |
                |     104 | Sumitabha Das |
                |     105 | Kumar         |
                |     106 | Tanenbaum     |
                +---------+---------------+
                6 rows in set (0.00 sec)
                
                (4)
                insert into Library_programme values(1,'Technical','Jayanagar');
                insert into Library_programme values(2,'Technical','Kuvempunagar');
                insert into Library_programme values(3,'Advanced Technology','Rajarajeshwarinagar');
                insert into Library_programme values(4,'Technical','Vijaynagar');
                insert into Library_programme values(5,'Advanced Technology','Vijaynagar');
                
                mysql> SELECT * FROM Library_Branch;
                +-----------+---------------------+---------------------+
                | Branch_id | Branch_name         | Address             |
                +-----------+---------------------+---------------------+
                |         1 | Technical           | Jayanagar           |
                |         2 | Technical           | Kuvempunagar        |
                |         3 | Advanced Technology | Rajarajeshwarinagar |
                |         4 | Technical           | Vijaynagar          |
                |         5 | Advanced Technology | Vijaynagar          |
                +-----------+---------------------+---------------------+
                5 rows in set (0.00 sec)
                
                (5)
                insert into Book_Copies values(101,1,100);
                insert into Book_Copies values(102,1,150);
                insert into Book_Copies values(101,2,200);
                insert into Book_Copies values(103,3,400);
                insert into Book_Copies values(105,4,140);
                insert into Book_Copies values(104,5,150);
                
                mysql> SELECT * FROM Book_Copies;
                +---------+-----------+--------------+
                | Book_id | Branch_id | No_of_copies |
                +---------+-----------+--------------+
                |     101 |         1 |          100 |
                |     101 |         2 |          200 |
                |     102 |         1 |          150 |
                |     103 |         3 |          400 |
                |     104 |         5 |          150 |
                |     105 |         4 |          140 |
                +---------+-----------+--------------+
                6 rows in set (0.00 sec)
                
                (6)
                insert into Book_Lending values(101,1,11,'2017-01-22','2017-02-07');
                insert into Book_Lending values(102,1,22,'2017-01-22','2017-04-07');
                insert into Book_Lending values(103,3,33,'2017-02-22','2017-04-07');
                insert into Book_Lending values(104,5,44,'2017-01-22','2017-06-07');
                insert into Book_Lending values(105,4,55,'2017-03-22','2017-05-07');
                insert into Book_Lending values(101,2,66,'2017-04-22','2017-05-07');
                insert into Book_Lending values(103,3,11,'2017-06-20','2017-07-07');
                insert into Book_Lending values(104,5,11,'2017-03-12','2017-05-07');
                insert into Book_Lending values(105,4,11,'2017-05-10','2017-05-07');
                
                mysql> SELECT * FROM Book_Lending;
                +---------+-----------+---------+------------+------------+
                | Book_id | Branch_id | Card_no | Date_Out   | Due_Date   |
                +---------+-----------+---------+------------+------------+
                |     101 |         1 | 11      | 2017-01-22 | 2017-02-07 |
                |     101 |         2 | 66      | 2017-04-22 | 2017-05-07 |
                |     102 |         1 | 22      | 2017-01-22 | 2017-04-07 |
                |     103 |         3 | 11      | 2017-06-20 | 2017-07-07 |
                |     103 |         3 | 33      | 2017-02-22 | 2017-04-07 |
                |     104 |         5 | 11      | 2017-03-12 | 2017-05-07 |
                |     104 |         5 | 44      | 2017-01-22 | 2017-06-07 |
                |     105 |         4 | 11      | 2017-05-10 | 2017-05-07 |
                |     105 |         4 | 55      | 2017-03-22 | 2017-05-07 |
                +---------+-----------+---------+------------+------------+
                9 rows in set (0.00 sec)
                
                
                QUERIES
                
                
                Write SQL queries to
                1. Retrieve details of all books in the library – id, title, name of publisher, authors,
                number of copies in each Programme, etc.
                
                2. Get the particulars of borrowers who have borrowed more than 3 books, but
                from Jan 2017 to Jun 2017.
                
                3. Delete a book in BOOK table. Update the contents of other tables to reflect this
                data manipulation operation.
                
                4. Partition the BOOK table based on year of publication. Demonstrate its working
                with a simple query.
                
                5. Create a view of all books and its number of copies that are currently available
                in the Library.
                
                1)select B.Book_id,Title,Publisher_name,Author_name,No_of_copies
                from Book B,Book_Authors A,Book_Copies C,Library_programme L
                where B.Book_id=A.Book_id and
                      B.Book_id=C.Book_id and
                      C.programme_id=L.programme_id;
                
                +---------+------------------------+----------------+---------------+--------------+
                | Book_id | Title                  | Publisher_name | Author_name   | No_of_copies |
                +---------+------------------------+----------------+---------------+--------------+
                |     101 | Programming in C       | PHI            | Balaguruswamy |          100 |
                |     101 | Programming in C       | PHI            | Balaguruswamy |          200 |
                |     102 | Programming in C#      | MHI            | Andearson     |          150 |
                |     103 | Computer Netwokrs      | Dreamtech      | Ferouzan      |          400 |
                |     104 | Unix Shell Programming | PHI            | Sumitabha Das |          150 |
                |     105 | Compiler Design        | PHI            | Kumar         |          140 |
                +---------+------------------------+----------------+---------------+--------------+
                
                2)select Card_no,count(*)
                from Book_Lending
                where Date_Out between '2017-01-01' and '2017-06-30'
                Group by Card_no
                Having count(*) > 3; 
                
                +---------+----------+
                | Card_no | count(*) |
                +---------+----------+
                | 11      |        4 |
                +---------+----------+
                
                3)delete from Book_Lending where Book_ID=102;
                {use on delete cascade for all tables while creating}
                
                delete from Book where Book_ID=102;
                
                SELECT * FROM Book_Lending;
                +---------+-----------+---------+------------+------------+
                | Book_id | Branch_id | Card_no | Date_Out   | Due_Date   |
                +---------+-----------+---------+------------+------------+
                |     101 |         1 | 11      | 2017-01-22 | 2017-02-07 |
                |     101 |         2 | 66      | 2017-04-22 | 2017-05-07 |
                |     103 |         3 | 11      | 2017-06-20 | 2017-07-07 |
                |     103 |         3 | 33      | 2017-02-22 | 2017-04-07 |
                |     104 |         5 | 11      | 2017-03-12 | 2017-05-07 |
                |     104 |         5 | 44      | 2017-01-22 | 2017-06-07 |
                |     105 |         4 | 11      | 2017-05-10 | 2017-05-07 |
                |     105 |         4 | 55      | 2017-03-22 | 2017-05-07 |
                +---------+-----------+---------+------------+------------+
                8 rows in set (0.00 sec)
                
                
                4)create view Book_Details as
                select B.Book_id,Title,No_of_copies,L.programme_id
                from Book B,Book_Copies C,Library_programme L
                where B.Book_id=C.Book_id and
                      C.programme_id=L.programme_id;
                
                select * from Book_Details;
                
                +---------+------------------------+--------------+--------------+
                | Book_id | Title                  | No_of_copies | programme_id |
                +---------+------------------------+--------------+--------------+
                |     101 | Programming in C       |          100 |            1 |
                |     102 | Programming in C#      |          150 |            1 |
                |     101 | Programming in C       |          200 |            2 |
                |     103 | Computer Netwokrs      |          400 |            3 |
                |     105 | Compiler Design        |          140 |            4 |
                |     104 | Unix Shell Programming |          150 |            5 |
                +---------+------------------------+--------------+--------------+
                
                
                5)create table b2(book_id int,title varchar(20),pname varchar(20),pyear int,constraint pkyb2 primary key(book_id,pyear))
                  partition by range(pyear)
                 ( partition p0 values less than(2000),
                  partition p1 values less than(2005),
                  partition p2 values less than(2010)); 
                
                insert into b2 values(2,'dbms','pearson',2000);
                insert into b2 values(2,'cn','pearson',2010);
                insert into b2 values(2,'cn','pearson',2009);
                insert into b2 values(2,'cn','pearson',1998);
                insert into b2 values(3,'se','navathe',2005);
                
                select *from b2;
                
                +---------+-------+---------+-------+
                | book_id | title | pname   | pyear |
                +---------+-------+---------+-------+
                |       2 | cn    | pearson |  1998 |
                |       2 | dbms  | pearson |  2000 |
                |       2 | cn    | pearson |  2009 |
                |       3 | se    | navathe |  2005 |
                +---------+-------+---------+-------+
                4 rows in set (0.00 sec)
                
                use information_schema;
                select * from partitions where table_name="b2";
                
                +---------------+--------------+------------+----------------+-------------------+----------------------------+-------------------------------+------------------+---------------------+----------------------+-------------------------+-----------------------+------------+----------------+-------------+-----------------+--------------+-----------+---------------------+---------------------+------------+----------+-------------------+-----------+-----------------+
                | TABLE_CATALOG | TABLE_SCHEMA | TABLE_NAME | PARTITION_NAME | SUBPARTITION_NAME | PARTITION_ORDINAL_POSITION | SUBPARTITION_ORDINAL_POSITION | PARTITION_METHOD | SUBPARTITION_METHOD | PARTITION_EXPRESSION | SUBPARTITION_EXPRESSION | PARTITION_DESCRIPTION | TABLE_ROWS | AVG_ROW_LENGTH | DATA_LENGTH | MAX_DATA_LENGTH | INDEX_LENGTH | DATA_FREE | CREATE_TIME         | UPDATE_TIME         | CHECK_TIME | CHECKSUM | PARTITION_COMMENT | NODEGROUP | TABLESPACE_NAME |
                +---------------+--------------+------------+----------------+-------------------+----------------------------+-------------------------------+------------------+---------------------+----------------------+-------------------------+-----------------------+------------+----------------+-------------+-----------------+--------------+-----------+---------------------+---------------------+------------+----------+-------------------+-----------+-----------------+
                | def           | library      | b2         | p0             | NULL              |                          1 |                          NULL | RANGE            | NULL                | `pyear`              | NULL                    | 2000                  |          1 |          16384 |       16384 |               0 |            0 |         0 | 2020-10-29 12:58:30 | 2020-10-29 12:58:45 | NULL       |     NULL |                   | default   | NULL            |
                | def           | library      | b2         | p1             | NULL              |                          2 |                          NULL | RANGE            | NULL                | `pyear`              | NULL                    | 2005                  |          1 |          16384 |       16384 |               0 |            0 |         0 | 2020-10-29 12:58:30 | 2020-10-29 12:58:45 | NULL       |     NULL |                   | default   | NULL            |
                | def           | library      | b2         | p2             | NULL              |                          3 |                          NULL | RANGE            | NULL                | `pyear`              | NULL                    | 2010                  |          2 |           8192 |       16384 |               0 |            0 |         0 | 2020-10-29 12:58:30 | 2020-10-29 12:58:49 | NULL       |     NULL |                   | default   | NULL            |
                +---------------+--------------+------------+----------------+-------------------+----------------------------+-------------------------------+------------------+---------------------+----------------------+-------------------------+-----------------------+------------+----------------+-------------+-----------------+--------------+-----------+---------------------+---------------------+------------+----------+-------------------+-----------+-----------------+
                3 rows in set (0.11 sec)
                
             <h2>Company database</h2>
             create table DEPARTMENT(Dname varchar(30),Dno int,Mgr_ssn varchar(10),Mgr_startdate date,constraint pkydept primary key(Dno));

             create table EMPLOYEE(Fname varchar(30),Midint varchar(30),Lname varchar(30),SSN varchar(10),Bdate date,Address varchar(30),Gender char(1),salary int,Super_ssn varchar(10),Dno int,
             constraint pkyemp primary key(SSN),constraint fkyemp foreign key(Dno) references DEPARTMENT(Dno));
             
             alter table DEPARTMENT add constraint fkydept foreign key(Mgr_ssn)references EMPLOYEE(SSN);
             alter table EMPLOYEE add constraint fkyempl foreign key(Super_ssn)references EMPLOYEE(SSN);
             
             create table DLOCATION(Dno int ,Dlocation varchar(30),constraint pkydloc primary key(DnO,Dlocation),constraint fkydloc foreign key(Dno)references DEPARTMENT(Dno));
             
             create table PROJECT(Pname varchar(30),Pno int,Plocation varchar(30),Dno int,constraint pkypro primary key(Pno),constraint fkypro foreign key(Dno) references DEPARTMENT(Dno));
             
             create table WORKS_ON(SSN varchar(10),Pno int,hours int,constraint pkywork primary key(SSN,Pno), constraint fkywork1 foreign key(SSN) references EMPLOYEE(SSN),
             constraint fkywork2 foreign key(Pno) references PROJECT(Pno));
             
             
             insert into DEPARTMENT values('research',5,null,'1988-05-22');
             insert into DEPARTMENT values('administration',4,null,'1995-01-01');
             insert into DEPARTMENT values('headquarters',1,null,'1981-06-19');
             
             mysql> select * from department;
             +----------------+-----+---------+---------------+
             | Dname          | Dno | Mgr_ssn | Mgr_startdate |
             +----------------+-----+---------+---------------+
             | headquarters   |   1 | NULL    | 1981-06-19    |
             | administration |   4 | NULL    | 1995-01-01    |
             | research       |   5 | NULL    | 1988-05-22    |
             +----------------+-----+---------+---------------+
             3 rows in set (0.00 sec)
             
             
             insert into EMPLOYEE values('john','b','smith',123456789,'1965-01-09','731 fondren houston tx','m',30000,null,5);
             insert into EMPLOYEE values('Franklin','T','Wong',333445555,'1955-12-08','638 Voss, Houston, TX','M',40000,null,4);
             insert into EMPLOYEE values('Alicia','J','Zelaya',999887777,'1968-01-19','3321 Castle, Spring, TX','F',25000,null,4);
             insert into EMPLOYEE values('Ramesh','K','Narayan',666884444,'1962-09-15','975 Fire Oak, Humble, TX','M',38000,null,5);
             insert into EMPLOYEE values('Joyce','A','English',453453453,'1972-07-31','5631 Rice, Houston, TX','F',25000,null,5);
             insert into EMPLOYEE values('Ahmad','V', 'Jabbar',987987987,'1969-03-29','980 Dallas, Houston, TX','M',25000,null,4);
             insert into EMPLOYEE values('James','E','Borg',888665555,'1937-11-10','450 Stone, Houston, TX','M',55000,null,1);
             
             mysql> select * from EMPLOYEE;
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             | Fname    | Midint | Lname   | SSN       | Bdate      | Address                  | Gender | salary | Super_ssn | Dno  |
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             | john     | b      | smith   | 123456789 | 1965-01-09 | 731 fondren houston tx   | m      |  30000 | NULL      |    5 |
             | Franklin | T      | Wong    | 333445555 | 1955-12-08 | 638 Voss, Houston, TX    | M      |  40000 | NULL      |    4 |
             | Joyce    | A      | English | 453453453 | 1972-07-31 | 5631 Rice, Houston, TX   | F      |  25000 | NULL      |    5 |
             | Ramesh   | K      | Narayan | 666884444 | 1962-09-15 | 975 Fire Oak, Humble, TX | M      |  38000 | NULL      |    5 |
             | James    | E      | Borg    | 888665555 | 1937-11-10 | 450 Stone, Houston, TX   | M      |  55000 | NULL      |    1 |
             | Ahmad    | V      | Jabbar  | 987987987 | 1969-03-29 | 980 Dallas, Houston, TX  | M      |  25000 | NULL      |    4 |
             | Alicia   | J      | Zelaya  | 999887777 | 1968-01-19 | 3321 Castle, Spring, TX  | F      |  25000 | NULL      |    4 |
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             7 rows in set (0.00 sec)
             
             
             update DEPARTMENT set mgr_ssn=333445555 where dno=5;
             update DEPARTMENT set mgr_ssn=987987987 where dno=4;
             update DEPARTMENT set mgr_ssn=888665555 where dno=1;
             
             mysql> select * from department;
             +----------------+-----+-----------+---------------+
             | Dname          | Dno | Mgr_ssn   | Mgr_startdate |
             +----------------+-----+-----------+---------------+
             | headquarters   |   1 | 888665555 | 1981-06-19    |
             | administration |   4 | 987987987 | 1995-01-01    |
             | research       |   5 | 333445555 | 1988-05-22    |
             +----------------+-----+-----------+---------------+
             3 rows in set (0.00 sec)
             
             
             mysql> update EMPLOYEE set super_ssn=333445555 where ssn=123456789;
             Query OK, 1 row affected (0.15 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=888665555 where ssn=333445555;
             Query OK, 1 row affected (0.14 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=333445555 where ssn=666884444;
             Query OK, 1 row affected (0.04 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=333445555 where ssn=453453453;
             Query OK, 1 row affected (0.04 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=666884444 where ssn = 888665555;
             Query OK, 1 row affected (0.04 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=888665555 where ssn = 987987987;
             Query OK, 1 row affected (0.15 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> update EMPLOYEE set super_ssn=453453453 where ssn = 999887777;
             Query OK, 1 row affected (0.06 sec)
             Rows matched: 1  Changed: 1  Warnings: 0
             
             mysql> select * from employee;
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             | Fname    | Midint | Lname   | SSN       | Bdate      | Address                  | Gender | salary | Super_ssn | Dno  |
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             | john     | b      | smith   | 123456789 | 1965-01-09 | 731 fondren houston tx   | m      |  30000 | 333445555 |    5 |
             | Franklin | T      | Wong    | 333445555 | 1955-12-08 | 638 Voss, Houston, TX    | M      |  40000 | 888665555 |    4 |
             | Joyce    | A      | English | 453453453 | 1972-07-31 | 5631 Rice, Houston, TX   | F      |  25000 | 333445555 |    5 |
             | Ramesh   | K      | Narayan | 666884444 | 1962-09-15 | 975 Fire Oak, Humble, TX | M      |  38000 | 333445555 |    5 |
             | James    | E      | Borg    | 888665555 | 1937-11-10 | 450 Stone, Houston, TX   | M      |  55000 | 666884444 |    1 |
             | Ahmad    | V      | Jabbar  | 987987987 | 1969-03-29 | 980 Dallas, Houston, TX  | M      |  25000 | 888665555 |    4 |
             | Alicia   | J      | Zelaya  | 999887777 | 1968-01-19 | 3321 Castle, Spring, TX  | F      |  25000 | 453453453 |    4 |
             +----------+--------+---------+-----------+------------+--------------------------+--------+--------+-----------+------+
             7 rows in set (0.01 sec)
             
             
             
             insert into DLOCATION values(1,'Houston');
             insert into DLOCATION values(4,'Stafford');
             insert into DLOCATION values(5,'Bellaire');
             insert into DLOCATION values(5,'Sugarland');
             insert into DLOCATION values(5,'Houston');
             
             mysql> select * from DLOCATION;
             +-----+-----------+
             | Dno | Dlocation |
             +-----+-----------+
             |   1 | Houston   |
             |   4 | Stafford  |
             |   5 | Bellaire  |
             |   5 | Houston   |
             |   5 | Sugarland |
             +-----+-----------+
             5 rows in set (0.00 sec)
             
             insert into PROJECT values('ProductX',1,'Bellaire',5);
             insert into PROJECT values('ProductY',2,'Sugarland',5);
             insert into PROJECT values('ProductZ',3,'Houston',5);
             insert into PROJECT values('Computerization',10,'Stafford',4);
             insert into PROJECT values('Reorganization',20,'Houston',1);
             insert into PROJECT values('Newbenefits',30,'Stafford',4);
             
             mysql> select * from PROJECT;
             +-----------------+-----+-----------+------+
             | Pname           | Pno | Plocation | Dno  |
             +-----------------+-----+-----------+------+
             | ProductX        |   1 | Bellaire  |    5 |
             | ProductY        |   2 | Sugarland |    5 |
             | ProductZ        |   3 | Houston   |    5 |
             | Computerization |  10 | Stafford  |    4 |
             | Reorganization  |  20 | Houston   |    1 |
             | Newbenefits     |  30 | Stafford  |    4 |
             +-----------------+-----+-----------+------+
             6 rows in set (0.00 sec)
             
             
             insert into WORKS_ON values(123456789,1,32.5);
             insert into WORKS_ON values(123456789,2,7.5);
             insert into WORKS_ON values(666884444,3,40.0);
             insert into WORKS_ON values(453453453,1,20.0);
             insert into WORKS_ON values(453453453,2,20.0);
             insert into WORKS_ON values(333445555,2,10.0);
             insert into WORKS_ON values(333445555,3,10.0);
             insert into WORKS_ON values(333445555,10,10.0);
             insert into WORKS_ON values(333445555,20,10.0);
             insert into WORKS_ON values(999887777,30,30.0);
             insert into WORKS_ON values(999887777,10,10.0);
             insert into WORKS_ON values(987987987,10,35.0);
             insert into WORKS_ON values(987987987,30,5.0);
             insert into WORKS_ON values(888665555,20,null);
             
             mysql> select * from WORKS_ON;
             +-----------+-----+-------+
             | SSN       | Pno | hours |
             +-----------+-----+-------+
             | 123456789 |   1 |    33 |
             | 123456789 |   2 |     8 |
             | 333445555 |   2 |    10 |
             | 333445555 |   3 |    10 |
             | 333445555 |  10 |    10 |
             | 333445555 |  20 |    10 |
             | 453453453 |   1 |    20 |
             | 453453453 |   2 |    20 |
             | 666884444 |   3 |    40 |
             | 888665555 |  20 |  NULL |
             | 987987987 |  10 |    35 |
             | 987987987 |  30 |     5 |
             | 999887777 |  10 |    10 |
             | 999887777 |  30 |    30 |
             +-----------+-----+-------+
             14 rows in set (0.00 sec)
             
             
             QUERIES
             
             1. Make a list of all project numbers for projects that involve an employee whose
             last name is ‘Scott’, either as a worker or as a manager of the department that
             controls the project.
             
             2. Show the resulting salaries if every employee working on the ‘IoT’ project is
             given a 10 percent raise.
             3. Find the sum of the salaries of all employees of the ‘Accounts’ department, as
             well as the maximum salary, the minimum salary, and the average salary in this
             department
             4. Retrieve the name of each employee who works on all the projects controlledby
             department number 5 (use NOT EXISTS operator).
             5. For each department that has more than five employees, retrieve the department
             number and the number of its employees who are making more than Rs.
             6,00,000.
             
             
             1)(select distinct P.Pno
                from PROJECT P,DEPARTMENT D,EMPLOYEE E
                where E.Dno=D.Dno
                and D.Mgr_ssn=E.SSN
             and E.Lname='smith')
             UNION
             (select P1.Pno
             from PROJECT P1,WORKS_ON W,EMPLOYEE E1
             WHERE P1.Pno=W.Pno
             and E1.SSN=W.SSN
             and E1.Lname='smith');
             
             +-----+
             | Pno |
             +-----+
             |   1 |
             |   2 |
             +-----+
             2 rows in set (0.00 sec)
             
             
             2)select E.Fname,E.Lname,1.1*E.Salary as INCR_SAL
             from EMPLOYEE E,WORKS_ON W,PROJECT P
             WHERE E.SSN=W.SSN
             AND W.Pno=P.Pno
             AND P.Pname='ProductX';
             
             +-------+---------+----------+
             | Fname | Lname   | INCR_SAL |
             +-------+---------+----------+
             | john  | smith   |  33000.0 |
             | Joyce | English |  27500.0 |
             +-------+---------+----------+
             2 rows in set (0.00 sec)
             
             
             3)select sum(E.Salary),max(E.Salary),min(E.Salary),avg(E.Salary)
             from EMPLOYEE E,DEPARTMENT D
             where E.Dno=D.Dno
             and D.Dname='Research';
             
             +---------------+---------------+---------------+---------------+
             | sum(E.Salary) | max(E.Salary) | min(E.Salary) | avg(E.Salary) |
             +---------------+---------------+---------------+---------------+
             |         93000 |         38000 |         25000 |    31000.0000 |
             +---------------+---------------+---------------+---------------+
             1 row in set (0.01 sec)
             
             
             4)select E.Fname,E.Lname
             from EMPLOYEE E
             where NOT EXISTS (select * 
                               from PROJECT P
                               where ( P.Pno in (select Pno
                                                 from PROJECT
                                                 where Dno='5')
                                                 and EXISTS (select * from WORKS_ON W
                                                             where E.SSN=W.SSN
                                                             and P.Pno=W.Pno)));
             +--------+--------+
             | Fname  | Lname  |
             +--------+--------+
             | James  | Borg   |
             | Ahmad  | Jabbar |
             | Alicia | Zelaya |
             +--------+--------+
             3 rows in set (0.00 sec)
             
             
             5)select D.Dno
             from DEPARTMENT D,EMPLOYEE E
             where D.Dno=E.Dno
             and E.Salary>20000
                 group by E.Dno
                 having count(*)>=2;
             +-----+
             | Dno |
             +-----+
             |   5 |
             |   4 |
             +-----+
             2 rows in set (0.00 sec)
             
             <h2>Salesman database</h2>
             
             create table SALESMAN(Salesman_id int,Name varchar(30),City varchar(30),Commission int,constraint pkySALESMAN primary key(Salesman_id));

             create table CUSTOMER(Customer_id int,Cust_name varchar(30),City varchar(30),Grade int,Salesman_id int,constraint pkyCUSTOMER primary key(Customer_id),
             constraint fkyCUSTOMER foreign key(Salesman_id) references SALESMAN(Salesman_id) on delete cascade);
             
             create table ORDER1(Ord_no int,Purchase_amt int,Ord_date date,Customer_id int,Salesman_id int,constraint pkyORDER1 primary key(Ord_no),
             constraint fkyORDER2 foreign key(Customer_id) references CUSTOMER(Customer_id) on delete cascade,
             constraint fkyORDER3 foreign key(Salesman_id) references SALESMAN(Salesman_id) on delete cascade);
             
             Insertion:
             
             mysql> insert into salesman values(1000,'John', 'Bangalore', 25);
             Query OK, 1 row affected (0.80 sec)
             
             mysql> insert into salesman values(2000,'ravi', 'Bangalore', 20);
             Query OK, 1 row affected (1.00 sec)
             
             mysql> insert into salesman values(3000,'kumar', 'Mysore', 15);
             Query OK, 1 row affected (0.66 sec)
             
             mysql> insert into salesman values(4000,'Smith', 'Delhi', 30);
             Query OK, 1 row affected (0.12 sec)
             
             mysql> insert into salesman values(5000,'harsha', 'Hyderabad', 15);
             Query OK, 1 row affected (0.19 sec)
             
             mysql> select * from salesman;
             +-------------+--------+-----------+------------+
             | Salesman_id | Name   | City      | Commission |
             +-------------+--------+-----------+------------+
             |        1000 | John   | Bangalore |         25 |
             |        2000 | ravi   | Bangalore |         20 |
             |        3000 | kumar  | Mysore    |         15 |
             |        4000 | Smith  | Delhi     |         30 |
             |        5000 | harsha | Hyderabad |         15 |
             +-------------+--------+-----------+------------+
             5 rows in set (0.27 sec)
             
             
             mysql> insert into customer values(10,'preethi','Bangalore',100,1000)
                 -> ;
             Query OK, 1 row affected (0.31 sec)
             
             mysql> insert into customer values(11,'vivek','mangalore',300,1000);
             Query OK, 1 row affected (0.16 sec)
             
             mysql> insert into customer values(12,'bhaskar','chennai',400,2000);
             Query OK, 1 row affected (0.18 sec)
             
             mysql> insert into customer values(13,'chethan','bangalore',200,2000);
             Query OK, 1 row affected (0.11 sec)
             
             mysql> insert into customer values(14,'mamatha','bangalore',400,3000);
             Query OK, 1 row affected (0.11 sec)
             
             mysql> select * from customer;;
             +-------------+-----------+-----------+-------+-------------+
             | Customer_id | Cust_name | City      | Grade | Salesman_id |
             +-------------+-----------+-----------+-------+-------------+
             |          10 | preethi   | Bangalore |   100 |        1000 |
             |          11 | vivek     | mangalore |   300 |        1000 |
             |          12 | bhaskar   | chennai   |   400 |        2000 |
             |          13 | chethan   | bangalore |   200 |        2000 |
             |          14 | mamatha   | bangalore |   400 |        3000 |
             +-------------+-----------+-----------+-------+-------------+
             5 rows in set (0.17 sec)
             
             mysql> insert into order1 values(50,5000,'2017-05-17',10,1000);
             Query OK, 1 row affected (0.89 sec)
             
             mysql> insert into order1 values(51,450,'2017-01-20',10,2000);
             Query OK, 1 row affected (0.09 sec)
             
             mysql> insert into order1 values(52,1000,'2017-02-24',13,2000);
             Query OK, 1 row affected (0.07 sec)
             
             mysql> insert into order1 values(53,3500,'2017-04-13',14,3000);
             Query OK, 1 row affected (0.10 sec)
             
             mysql> insert into order1 values(54,550,'2017-03-09',12,2000);
             Query OK, 1 row affected (0.04 sec)
             
             mysql> select * from order1;
             +--------+--------------+------------+-------------+-------------+
             | Ord_no | Purchase_amt | Ord_date   | Customer_id | Salesman_id |
             +--------+--------------+------------+-------------+-------------+
             |     50 |         5000 | 2017-05-17 |          10 |        1000 |
             |     51 |          450 | 2017-01-20 |          10 |        2000 |
             |     52 |         1000 | 2017-02-24 |          13 |        2000 |
             |     53 |         3500 | 2017-04-13 |          14 |        3000 |
             |     54 |          550 | 2017-03-09 |          12 |        2000 |
             +--------+--------------+------------+-------------+-------------+
             5 rows in set (0.02 sec)
             
             
             QUERIES:
             
             1. Count the customers with grades above Bangalore’s average.
             2. Find the name and numbers of all salesman who had more than one customer.
             3. List all the salesman and indicate those who have and don’t have customers in
             their cities (Use UNION operation.)
             4. Create a view that finds the salesman who has the customer with the highest order
             of a day.
             5. Demonstrate the DELETE operation by removing salesman with id 1000. All
             his orders must also be deleted. 
             
             1)select Grade, count(distinct Customer_id)
             from CUSTOMER   
             group by Grade
             having Grade>(select avg(Grade)
                           from CUSTOMER
                           where City='Bangalore');
             
             +-------+-----------------------------+
             | Grade | count(distinct Customer_id) |
             +-------+-----------------------------+
             |   300 |                           1 |
             |   400 |                           2 |
             +-------+-----------------------------+
             
             
             2)select Name,Salesman_id
             from SALESMAN A
             where 1 < (select count(*)
                        from CUSTOMER
                        where Salesman_id=A.Salesman_id);
             
             
             +------+-------------+
             | Name | Salesman_id |
             +------+-------------+
             | John |        1000 |
             | ravi |        2000 |
             +------+-------------+
             
             
             
             3)(select distinct S.Name 
                from CUSTOMER C,SALESMAN S
                where S.Salesman_id=C.Salesman_id
                and S.City=C.City)
             UNION
             (select distinct Name 
              from SALESMAN
             where Salesman_id not in(select S.Salesman_id from SALESMAN S,CUSTOMER C
                                      where S.Salesman_id=C.Salesman_id
                                      and S.City=C.City));
             
             +--------+
             | Name   |
             +--------+
             | John   |
             | ravi   |
             | kumar  |
             | Smith  |
             | harsha |
             +--------+
             5 rows in set (0.00 sec)
             
             
             4)create view EliteSalesman as
               select B.Ord_date,A.Salesman_id,A.Name
               from SALESMAN A,ORDER1 B
               where A.Salesman_id=B.Salesman_id
               and B.Purchase_amt =(select MAX(Purchase_amt)
                                    from ORDER1 C
                                    where C.Ord_date=B.Ord_date);
             
             mysql> select * from EliteSalesman;
             +------------+-------------+-------+
             | Ord_date   | Salesman_id | Name  |
             +------------+-------------+-------+
             | 2017-05-17 |        1000 | John  |
             | 2017-01-20 |        2000 | ravi  |
             | 2017-02-24 |        2000 | ravi  |
             | 2017-04-13 |        3000 | kumar |
             | 2017-03-09 |        2000 | ravi  |
             +------------+-------------+-------+
             5 rows in set (0.00 sec)
             
             
             5)
             delete from Salesman where Salesman_id=1000; 
             
             delete from ORDER1 where Salesman_id=1000; 
            
             <h2>Movie database</h2>

             create table ACTOR(Act_id int,Act_name varchar(30),Act_gender char(1),constraint pkyACTOR primary key(Act_id));

             create table DIRECTOR(Dir_id int,Dir_name varchar(30),Dir_phone varchar(30),constraint pkyDIRECTOR primary key(Dir_id));
             
             create table MOVIES(Mov_id int,Mov_title varchar(30),Mov_year int,Mov_lang varchar(30),Dir_id int,constraint pkyMOVIES primary key(Mov_id),
             constraint fkyMOVIES foreign key(Dir_id) references DIRECTOR(Dir_id));
             
             create table MOVIE_CAST(Act_id int,Mov_id int,Role varchar(30),constraint pkyMOVIE_CAST primary key(Act_id,Mov_id),
             constraint fkyMOVIE_CAST1 foreign key(Act_id) references ACTOR(Act_id),
             constraint fkyMOVIE_CAST2 foreign key(Mov_id) references MOVIES(Mov_id));
             
             create table RATING(Mov_id int,Rev_stars int,constraint pkyRATING primary key(Mov_id),
             constraint fkyRATING foreign key(Mov_id) references MOVIES(Mov_id));
             
             
             insert into ACTOR values(301,'Anushka','F');
             insert into ACTOR values(302,'Prabhas','M');
             insert into ACTOR values(303,'Punith','M');
             insert into ACTOR values(304,'Jermy','M');
             
             
             insert into DIRECTOR values(60,'Rajamouli','8751611001');
             insert into DIRECTOR values(61,'Hitchcock','7766138911');
             insert into DIRECTOR values(62,'Faran','9986776531');
             insert into DIRECTOR values(63,'Steven Spielberg','8989776530');
             
             
             insert into MOVIES values(1001,'Bahubali-2',2017,'Telagu',60);
             insert into MOVIES values(1002,'Bahubali-1',2015,'Telagu',60);
             insert into MOVIES values(1003,'Iceage',2008,'Kannada',61);
             insert into MOVIES values(1004,'War Horse',2011,'English',63);
             
             
             insert into MOVIE_CAST values(301,1002,'Heroine');
             insert into MOVIE_CAST values(301,1001,'Heroine');
             insert into MOVIE_CAST values(303,1003,'Hero');
             insert into MOVIE_CAST values(303,1002,'Guest');
             insert into MOVIE_CAST values(304,1004,'Hero');
             
             
             insert into RATING values(1001,4);
             insert into RATING values(1002,2);
             insert into RATING values(1003,5);
             insert into RATING values(1004,4);
             
             
             MariaDB [MOVIE]> select * from Actor;
             +--------+----------+------------+
             | Act_id | Act_name | Act_gender |
             +--------+----------+------------+
             |    301 | Anushka  | F          |
             |    302 | Prabhas  | M          |
             |    303 | Punith   | M          |
             |    304 | Jermy    | M          |
             +--------+----------+------------+
             4 rows in set (0.00 sec)
             
             MariaDB [MOVIE]> select * from Director;
             +--------+------------------+------------+
             | Dir_id | Dir_name         | Dir_phone  |
             +--------+------------------+------------+
             |     60 | Rajamouli        | 8751611001 |
             |     61 | Hitchcock        | 7766138911 |
             |     62 | Faran            | 9986776531 |
             |     63 | Steven Spielberg | 8989776530 |
             +--------+------------------+------------+
             4 rows in set (0.00 sec)
             
             MariaDB [MOVIE]> select * from Movies;
             +--------+------------+----------+----------+--------+
             | Mov_id | Mov_title  | Mov_year | Mov_lang | Dir_id |
             +--------+------------+----------+----------+--------+
             |   1001 | Bahubali-2 |     2017 | Telagu   |     60 |
             |   1002 | Bahubali-1 |     2015 | Telagu   |     60 |
             |   1003 | Iceage     |     2008 | Kannada  |     61 |
             |   1004 | War Horse  |     2011 | English  |     63 |
             +--------+------------+----------+----------+--------+
             4 rows in set (0.00 sec)
             
             MariaDB [MOVIE]> select * from Movie_cast;
             +--------+--------+---------+
             | Act_id | Mov_id | Role    |
             +--------+--------+---------+
             |    301 |   1001 | Heroine |
             |    301 |   1002 | Heroine |
             |    303 |   1002 | Guest   |
             |    303 |   1003 | Hero    |
             |    304 |   1004 | Hero    |
             +--------+--------+---------+
             5 rows in set (0.00 sec)
             
             
             MariaDB [MOVIE]> select * from Rating;
             +--------+-----------+
             | Mov_id | Rev_stars |
             +--------+-----------+
             |   1001 |         4 |
             |   1002 |         2 |
             |   1003 |         5 |
             |   1004 |         4 |
             +--------+-----------+
             4 rows in set (0.00 sec)
             
             Write SQL queries to
             1. List the titles of all movies directed by ‘Hitchcock’.
             2. Find the movie names where one or more actors acted in two or more movies.
             3. List all actors who acted in a movie before 2000 and also in a movie after 2015
             (use JOIN operation).
             4. Find the title of movies and number of stars for each movie that has at least one
             rating and find the highest number of stars that movie received. Sort the result by
             movie title.
             5. Update rating of all movies directed by ‘Steven Spielberg’ to 5.
             
             
             QUERIES SOLUTION
             
             1)select Mov_title
             from MOVIES M,DIRECTOR D
             where Dir_name="Hitchcock" and
             M.Dir_id=D.Dir_id;
             
             +-----------+
             | Mov_title |
             +-----------+
             | Iceage    |
             +-----------+
             1 row in set (0.03 sec)
             
             
             
             
             2)select Mov_title
             from MOVIES M,MOVIE_CAST C
             where M.Mov_id=C.Mov_id and Act_id in(select Act_id
                                                  from MOVIE_CAST
                                                  group by Act_id
                                                  having count(Act_id) > 1);
             
             +------------+
             | Mov_title  |
             +------------+
             | Bahubali-2 |
             | Bahubali-1 |
             | Bahubali-1 |
             | Iceage     |
             +------------+
             4 rows in set (0.00 sec)
             
             
             
             3)select Act_name,Mov_title,Mov_year
             from ACTOR A
             join MOVIE_CAST C
             ON A.Act_id=C.Act_id
             join MOVIES M
             on C.Mov_id=M.Mov_id
             where M.Mov_year not between 2000 and 2015;
             
             +----------+------------+----------+
             | Act_name | Mov_title  | Mov_year |
             +----------+------------+----------+
             | Anushka  | Bahubali-2 |     2017 |
             +----------+------------+----------+
             1 row in set (0.00 sec)
             
             
             
             4)select Mov_title,max(Rev_stars)
             from MOVIES M
             inner join RATING using (Mov_id)
                               group by Mov_title
                               having max(Rev_stars) > 0
             order by Mov_title;
             
             
             +------------+----------------+
             | Mov_title  | max(Rev_stars) |
             +------------+----------------+
             | Bahubali-1 |              2 |
             | Bahubali-2 |              4 |
             | Iceage     |              5 |
             | War Horse  |              4 |
             +------------+----------------+
             4 rows in set (0.00 sec)
             
             
             
             5) update RATING 
             set Rev_stars=5
             where Mov_id in(select Mov_id
                             from MOVIES 
                             where Dir_id in
                             (select Dir_id from DIRECTOR
                              where Dir_name ="Steven Spielberg"));
             
             MariaDB [movie]> select * from rating;
             +--------+-----------+
             | Mov_id | Rev_stars |
             +--------+-----------+
             |   1001 |         4 |
             |   1002 |         2 |
             |   1003 |         5 |
             |   1004 |         5 |
             +--------+-----------+
             4 rows in set (0.00 sec)
             
             
             


                </code>
            </pre>
        </div>
    </div>
</body>

</html>